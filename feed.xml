<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://xkcococo.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://xkcococo.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2023-06-08T17:41:55+00:00</updated><id>https://xkcococo.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Preprocessing Microbiome Sequences with QIIME 2 - A Guide to Importing, Trimming, Denoising, and Classifying 16S Suquencing Data</title><link href="https://xkcococo.github.io/blog/2023/Use-QIIME2-to-Preprocess-16S-Sequencing-Files/" rel="alternate" type="text/html" title="Preprocessing Microbiome Sequences with QIIME 2 - A Guide to Importing, Trimming, Denoising, and Classifying 16S Suquencing Data"/><published>2023-01-12T00:00:00+00:00</published><updated>2023-01-12T00:00:00+00:00</updated><id>https://xkcococo.github.io/blog/2023/Use-QIIME2-to-Preprocess-16S-Sequencing-Files</id><content type="html" xml:base="https://xkcococo.github.io/blog/2023/Use-QIIME2-to-Preprocess-16S-Sequencing-Files/"><![CDATA[<p><strong>The latest QIIME 2 tutorials version <a href="https://docs.qiime2.org/2022.11/">2022.11</a>.</strong> This tutorial is based on the latest version of QIIME 2, 2022.11. Before starting, it’s recommended to review the QIIME 2 tutorials to understand the different functions and plugins available.</p> <p><br/> <strong>Step 1: Importing Data in QIIME2.</strong></p> <p>Before importing your data, it is important to identify the correct sequencing file format. The format of your sequencing files can be compared to the formats listed on <a href="https://docs.qiime2.org/2022.11/tutorials/importing/">this page</a>.</p> <p>For the purpose of this tutorial, let’s use <code class="language-plaintext highlighter-rouge">Casava 1.8 paired-end demultiplexed fastq</code> as an example. This format consists of two <code class="language-plaintext highlighter-rouge">fastq.gz</code> files for each sample, with names such as <code class="language-plaintext highlighter-rouge">L2S357_15_L001_R1_001.fastq.gz</code> and <code class="language-plaintext highlighter-rouge">L2S357_15_L001_R2_001.fastq.gz</code>. The <code class="language-plaintext highlighter-rouge">R1</code> and <code class="language-plaintext highlighter-rouge">R2</code> stand for one forward and one reverse sequencing file, respectively.</p> <p>The fields in the file name, separated by underscores, are: <code class="language-plaintext highlighter-rouge">sample identifier</code>, <code class="language-plaintext highlighter-rouge">barcode sequence or barcode identifier</code>, <code class="language-plaintext highlighter-rouge">lane number</code>, <code class="language-plaintext highlighter-rouge">read direction (i.e. R1 or R2)</code>, and <code class="language-plaintext highlighter-rouge">set number</code>.</p> <p>To import your data, run the following code:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qiime tools import  \
  --type 'SampleData[PairedEndSequencesWithQuality]'  \
  --input-path /path/you/saved/sequencing/files/afog16s-all-modified/seq  \
  --input-format CasavaOneEightSingleLanePerSampleDirFmt  \
  --output-path /path/you/saved/your/output/demux-paired-end_demodata.qza
</code></pre></div></div> <p>This will import your demultiplexed paired-end sequences, ready for adapter trimming.</p> <p><br/> <strong>Step 2: Searching Demultiplexed Paired-end Sequences For Adapters and Remove Them.</strong></p> <p>If adapters were used during PCR procedures, they need to be searched for and removed from all reads using Cutadapt. For the purposes of this tutorial, let’s suppose the adapter in all forward sequences is <code class="language-plaintext highlighter-rouge">GACTACCAGGGTATCTAATCCTGTTTGCTCCCC</code>, and the adapter in all reverse sequences is <code class="language-plaintext highlighter-rouge">CCTACGGGAGGCAGCAGTGGGGAATATTGCACAAT</code>.</p> <p>To trim the adapters, run the following code:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qiime cutadapt trim-paired \
  --i-demultiplexed-sequences demux-paired-end_demodata.qza \
  --p-front-f GACTACCAGGGTATCTAATCCTGTTTGCTCCCC \
  --p-front-r CCTACGGGAGGCAGCAGTGGGGAATATTGCACAAT \
  --p-error-rate 0 \
  --o-trimmed-sequences /path/you/saved/your/output/trimmed-seq.qza \
  --verbose
</code></pre></div></div> <p>Let’s move on to the next step of denoising our trimmed sequence data.</p> <p><br/> <strong>Step 3: Sequence Denoising with DADA2.</strong></p> <p>Before we denoise our sequence data, we need to visualize it using the <a href="https://view.qiime2.org/">QIIME 2 view</a>. This allows us to determine the parameters for denoising. To do this, we will use the following command:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qiime demux summarize \
  --i-data trimmed-seq.qza \
  --o-visualization trimmed-seq.qzv
</code></pre></div></div> <p>We can then drop the trimmed-seq.qzv file into the view window. The parameters of <code class="language-plaintext highlighter-rouge">p-trim-left-f</code>, <code class="language-plaintext highlighter-rouge">p-trim-left-r</code>, <code class="language-plaintext highlighter-rouge">p-trunc-len-f</code>, and <code class="language-plaintext highlighter-rouge">p-trunc-len-r</code> will be determined based on the overall quality of the reads.</p> <p>To perform the denoising, we will use the following command:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qiime dada2 denoise-paired \
  --i-demultiplexed-seqs 'trimmed-seq.qza' \
  --p-trim-left-f 0 \
  --p-trim-left-r 0 \
  --p-trunc-len-f 220 \
  --p-trunc-len-r 200 \
  --o-representative-sequences rep-seqs-dada2.qza \
  --o-table table-dada2.qza \
  --o-denoising-stats satats-dada2.qza \
  --p-n-threads 24
</code></pre></div></div> <p>With this command, we have generated <code class="language-plaintext highlighter-rouge">table-dada2.qza</code> and <code class="language-plaintext highlighter-rouge">rep-seqs-dada2.qza</code> for creating the taxonomy table and feature table.</p> <p><br/> <strong>Step 4: Generating the Taxonomy Table.</strong></p> <p>There are two options for generating the taxonomy table:</p> <ol> <li><a href="https://docs.qiime2.org/2022.11/tutorials/feature-classifier/">Train your own feature classifier</a>, or 2. Use a <a href="https://docs.qiime2.org/2022.11/data-resources/">pre-traiend feature classifier</a> provided by QIIME 2.</li> </ol> <p>In this tutorial, we will use the pre-trained classifier “Silva 138 99% OTUs full-length sequences.”</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#download classifier
wget -O "silva-138-99-nb-classifier.qza" "https://data.qiime2.org/2020.8/common/silva-138-99-nb-classifier.qza"

qiime feature-classifier classify-sklearn \
  --i-classifier silva-138-99-nb-classifier.qza \
  --i-reads rep-seqs-dada2.qza \
  --o-classification taxonomy.qza

#Export taxonomy info in .tsv format
qiime tools export 
  --input-path taxonomy.qza \
  --output-path exported-feature-table
</code></pre></div></div> <p>With this, we have generated the taxonomy table in <code class="language-plaintext highlighter-rouge">.tsv</code> format.</p> <p><br/> <strong>Step 5: Generating Feature Table for Each Sample.</strong></p> <p>In this step, we will use <code class="language-plaintext highlighter-rouge">table-dada2.qza</code> to generate our feature table.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#Creating a TSV BIOM table
#first, export your data as a .biom
qiime tools export --input-path table-dada2.qza --output-path exported-feature-table


#Covert .biom to .tsv
biom convert -i exported-feature-table/feature-table.biom -o exported-feature-table/feature-table.tsv --to-tsv
biom head -i feature-table.tsv
</code></pre></div></div> <p><br/> <strong>Step 6: Combining the Feature Table and Taxonomy Table.</strong></p> <p>At this point, you should have two output files: <code class="language-plaintext highlighter-rouge">taxonomy.tsv</code> and <code class="language-plaintext highlighter-rouge">feature-table.tsv</code>. These two tables can be combined by using the sequencing id as the key.</p> <p><br/> <strong>You’re all set! You now have everything you need to perform your downstream statistical analysis. Enjoy!</strong></p>]]></content><author><name>Ke Xu</name></author><category term="QIIME2"/><category term="16S"/><category term="sequencing"/><category term="fastq"/><summary type="html"><![CDATA[The latest QIIME 2 tutorials version 2022.11. This tutorial is based on the latest version of QIIME 2, 2022.11. Before starting, it’s recommended to review the QIIME 2 tutorials to understand the different functions and plugins available.]]></summary></entry></feed>